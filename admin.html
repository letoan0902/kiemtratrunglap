<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - H·ªá th·ªëng Ki·ªÉm tra Tr√πng l·∫∑p</title>
    
    <!-- Favicon v√† Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="images/logoLeToan.png?v=2">
    <link rel="icon" type="image/png" sizes="16x16" href="images/logoLeToan.png?v=2">    
    <link rel="apple-touch-icon" sizes="180x180" href="images/logoLeToan.png?v=2">
    <link rel="shortcut icon" href="images/logoLeToan.png?v=2">
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Admin Panel - H·ªá th·ªëng ki·ªÉm tra tr√πng l·∫∑p d·ªØ li·ªáu">
    <meta name="keywords" content="admin panel, qu·∫£n tr·ªã, ki·ªÉm tra tr√πng l·∫∑p, qu·∫£n l√Ω d·ªØ li·ªáu">
    <meta name="author" content="Le Toan System">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Admin Panel - H·ªá th·ªëng Ki·ªÉm tra Tr√πng l·∫∑p">
    <meta property="og:description" content="Trang qu·∫£n tr·ªã h·ªá th·ªëng ki·ªÉm tra tr√πng l·∫∑p d·ªØ li·ªáu">
    <meta property="og:image" content="images/logoLeToan.png">
    <meta property="og:type" content="website">
    
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/admin.css">
    <!-- SheetJS Library for Excel Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-content">
            <div class="nav-brand">
                <img src="images/logoLeToan.png" alt="Le Toan Logo" class="nav-logo">
                <span>Admin Panel</span>
            </div>
            <div class="nav-links">
                <span id="userInfo" class="nav-link"></span>
                <a href="#" id="logoutBtn" class="nav-link">ƒêƒÉng xu·∫•t</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- Statistics -->
        <div class="stats" id="statsContainer">
            <div class="stat-card">
                <div class="stat-number" id="totalUsers">0</div>
                <div class="stat-label">Ng∆∞·ªùi d√πng</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalFields">0</div>
                <div class="stat-label">Tr∆∞·ªùng d·ªØ li·ªáu</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalData">0</div>
                <div class="stat-label">T·ªïng d·ªØ li·ªáu</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalDuplicates">0</div>
                <div class="stat-label">Tr√πng l·∫∑p</div>
            </div>
        </div>

        <!-- Tab Navigation -->
        <div class="tab-navigation" style="margin-bottom: 30px; border-bottom: 2px solid #ffb380;">
            <button class="tab-btn active" data-tab="users">üë• Qu·∫£n l√Ω Ng∆∞·ªùi d√πng</button>
            <button class="tab-btn" data-tab="fields">üìä Qu·∫£n l√Ω Tr∆∞·ªùng</button>
            <button class="tab-btn" data-tab="data">üíæ Xem D·ªØ li·ªáu</button>
            <button class="tab-btn" data-tab="userdata">üë§ Ki·ªÉm tra User Data</button>
            <button class="tab-btn" data-tab="export">üì§ Xu·∫•t d·ªØ li·ªáu</button>
        </div>

        <!-- Users Tab -->
        <div class="tab-content active" id="tab-users">
            <div class="dashboard-container">
                <div class="card-header">
                    <h2 class="card-title">Qu·∫£n l√Ω Ng∆∞·ªùi d√πng</h2>
                    <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                        <div class="search-container">
                            <input type="text" id="userSearchBox" class="form-input search-input" placeholder="üîç T√¨m ki·∫øm ng∆∞·ªùi d√πng..." style="width: 250px; margin: 0;" autocomplete="off">
                            <button class="search-clear-btn" id="userSearchClear" title="X√≥a t√¨m ki·∫øm">√ó</button>
                        </div>
                        <select id="userStatusFilter" class="status-filter-select">
                            <option value="">T·∫•t c·∫£ tr·∫°ng th√°i</option>
                            <option value="active">‚úÖ Ho·∫°t ƒë·ªông</option>
                            <option value="locked">üîí B·ªã kh√≥a</option>
                        </select>
                        <button class="btn btn-primary" id="addUserBtn">‚ûï Th√™m ng∆∞·ªùi d√πng</button>
                    </div>
                </div>
                
                <!-- Column Search Row -->
                <div class="column-search-container" id="userColumnSearch" style="display: none;">
                    <div class="column-search-grid">
                        <div class="column-search-item">
                            <label>T√™n:</label>
                            <div class="search-container">
                                <input type="text" class="column-search-input" data-column="0" placeholder="T√¨m theo t√™n..." autocomplete="off">
                                <button class="search-clear-btn" onclick="this.previousElementSibling.value=''; this.closest('.column-search-container').dispatchEvent(new Event('search'));">√ó</button>
                            </div>
                        </div>
                        <div class="column-search-item">
                            <label>Email:</label>
                            <div class="search-container">
                                <input type="text" class="column-search-input" data-column="1" placeholder="T√¨m theo email..." autocomplete="off">
                                <button class="search-clear-btn" onclick="this.previousElementSibling.value=''; this.closest('.column-search-container').dispatchEvent(new Event('search'));">√ó</button>
                            </div>
                        </div>
                        <div class="column-search-item">
                            <label>Ng√†y t·∫°o:</label>
                            <div class="search-container">
                                <input type="text" class="column-search-input" data-column="3" placeholder="T√¨m theo ng√†y..." autocomplete="off">
                                <button class="search-clear-btn" onclick="this.previousElementSibling.value=''; this.closest('.column-search-container').dispatchEvent(new Event('search'));">√ó</button>
                            </div>
                        </div>
                        <div class="column-search-item">
                            <label>T·∫°o b·ªüi:</label>
                            <div class="search-container">
                                <input type="text" class="column-search-input" data-column="4" placeholder="T√¨m theo ng∆∞·ªùi t·∫°o..." autocomplete="off">
                                <button class="search-clear-btn" onclick="this.previousElementSibling.value=''; this.closest('.column-search-container').dispatchEvent(new Event('search'));">√ó</button>
                            </div>
                        </div>
                        <div class="column-search-actions">
                            <button class="btn btn-secondary btn-sm" onclick="adminPanel.clearAllColumnSearch('userColumnSearch')">X√≥a t·∫•t c·∫£</button>
                            <button class="btn btn-secondary btn-sm" onclick="adminPanel.hideColumnSearch('userColumnSearch')">·∫®n</button>
                        </div>
                    </div>
                </div>
                
                <div id="usersTableContainer">
                    <!-- Users table will be generated here -->
                </div>
            </div>
        </div>

        <!-- Fields Tab -->
        <div class="tab-content" id="tab-fields">
            <div class="dashboard-container">
                <div class="card-header">
                    <h2 class="card-title">Qu·∫£n l√Ω Tr∆∞·ªùng D·ªØ li·ªáu</h2>
                    <div style="display: flex; gap: 15px; align-items: center;">
                        <div class="search-container">
                            <input type="text" id="fieldSearchBox" class="form-input search-input" placeholder="üîç T√¨m ki·∫øm tr∆∞·ªùng..." style="width: 250px; margin: 0;" autocomplete="off">
                            <button class="search-clear-btn" id="fieldSearchClear" title="X√≥a t√¨m ki·∫øm">√ó</button>
                        </div>
                        <button class="btn btn-primary" id="addFieldBtn">‚ûï Th√™m tr∆∞·ªùng</button>
                    </div>
                </div>
                
                <!-- Column Search Row -->
                <div class="column-search-container" id="fieldColumnSearch" style="display: none;">
                    <div class="column-search-grid">
                        <div class="column-search-item">
                            <label>T√™n tr∆∞·ªùng:</label>
                            <div class="search-container">
                                <input type="text" class="column-search-input" data-column="0" placeholder="T√¨m theo t√™n..." autocomplete="off">
                                <button class="search-clear-btn" onclick="this.previousElementSibling.value=''; this.closest('.column-search-container').dispatchEvent(new Event('search'));">√ó</button>
                            </div>
                        </div>
                        <div class="column-search-item">
                            <label>M√¥ t·∫£:</label>
                            <div class="search-container">
                                <input type="text" class="column-search-input" data-column="1" placeholder="T√¨m theo m√¥ t·∫£..." autocomplete="off">
                                <button class="search-clear-btn" onclick="this.previousElementSibling.value=''; this.closest('.column-search-container').dispatchEvent(new Event('search'));">√ó</button>
                            </div>
                        </div>
                        <div class="column-search-item">
                            <label>Ng√†y t·∫°o:</label>
                            <div class="search-container">
                                <input type="text" class="column-search-input" data-column="4" placeholder="T√¨m theo ng√†y..." autocomplete="off">
                                <button class="search-clear-btn" onclick="this.previousElementSibling.value=''; this.closest('.column-search-container').dispatchEvent(new Event('search'));">√ó</button>
                            </div>
                        </div>
                        <div class="column-search-item">
                            <label>T·∫°o b·ªüi:</label>
                            <div class="search-container">
                                <input type="text" class="column-search-input" data-column="5" placeholder="T√¨m theo ng∆∞·ªùi t·∫°o..." autocomplete="off">
                                <button class="search-clear-btn" onclick="this.previousElementSibling.value=''; this.closest('.column-search-container').dispatchEvent(new Event('search'));">√ó</button>
                            </div>
                        </div>
                        <div class="column-search-actions">
                            <button class="btn btn-secondary btn-sm" onclick="adminPanel.clearAllColumnSearch('fieldColumnSearch')">X√≥a t·∫•t c·∫£</button>
                            <button class="btn btn-secondary btn-sm" onclick="adminPanel.hideColumnSearch('fieldColumnSearch')">·∫®n</button>
                        </div>
                    </div>
                </div>
                
                <div id="fieldsTableContainer">
                    <!-- Fields table will be generated here -->
                </div>
            </div>
        </div>

        <!-- Data Tab -->
        <div class="tab-content" id="tab-data">
            <div class="dashboard-container">
                <div class="card-header">
                    <h2 class="card-title">Xem D·ªØ li·ªáu Theo Tr∆∞·ªùng</h2>
                    <div style="display: flex; gap: 15px; align-items: center;">
                        <div class="search-container">
                            <input type="text" id="dataSearchBox" class="form-input search-input" placeholder="üîç T√¨m ki·∫øm d·ªØ li·ªáu..." style="width: 250px; margin: 0;" autocomplete="off">
                            <button class="search-clear-btn" id="dataSearchClear" title="X√≥a t√¨m ki·∫øm">√ó</button>
                        </div>
                        <div class="custom-select" id="fieldSelectContainer">
                            <div class="select-trigger" id="fieldSelectTrigger">
                                <span>Ch·ªçn tr∆∞·ªùng ƒë·ªÉ xem</span>
                                <span class="arrow">‚ñº</span>
                            </div>
                            <ul class="select-options" id="fieldSelectOptions">
                                <li data-value="">Ch·ªçn tr∆∞·ªùng ƒë·ªÉ xem</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Column Search Row -->
                <div class="column-search-container" id="dataColumnSearch" style="display: none;">
                    <div class="column-search-grid">
                        <div class="column-search-item">
                            <label>D·ªØ li·ªáu:</label>
                            <div class="search-container">
                                <input type="text" class="column-search-input" data-column="0" placeholder="T√¨m theo d·ªØ li·ªáu..." autocomplete="off">
                                <button class="search-clear-btn" onclick="this.previousElementSibling.value=''; this.closest('.column-search-container').dispatchEvent(new Event('search'));">√ó</button>
                            </div>
                        </div>
                        <div class="column-search-item">
                            <label>Th√™m b·ªüi:</label>
                            <div class="search-container">
                                <input type="text" class="column-search-input" data-column="1" placeholder="T√¨m theo ng∆∞·ªùi th√™m..." autocomplete="off">
                                <button class="search-clear-btn" onclick="this.previousElementSibling.value=''; this.closest('.column-search-container').dispatchEvent(new Event('search'));">√ó</button>
                            </div>
                        </div>
                        <div class="column-search-item">
                            <label>Ng√†y th√™m:</label>
                            <div class="search-container">
                                <input type="text" class="column-search-input" data-column="2" placeholder="T√¨m theo ng√†y..." autocomplete="off">
                                <button class="search-clear-btn" onclick="this.previousElementSibling.value=''; this.closest('.column-search-container').dispatchEvent(new Event('search'));">√ó</button>
                            </div>
                        </div>
                        <div class="column-search-actions">
                            <button class="btn btn-secondary btn-sm" onclick="adminPanel.clearAllColumnSearch('dataColumnSearch')">X√≥a t·∫•t c·∫£</button>
                            <button class="btn btn-secondary btn-sm" onclick="adminPanel.hideColumnSearch('dataColumnSearch')">·∫®n</button>
                        </div>
                    </div>
                </div>
                
                <div id="dataTableContainer">
                    <!-- Data table will be generated here -->
                </div>
            </div>
        </div>

        <!-- User Data Review Tab -->
        <div class="tab-content" id="tab-userdata">
            <div class="dashboard-container">
                <div class="card-header">
                    <h2 class="card-title">Ki·ªÉm tra D·ªØ li·ªáu User Chi ti·∫øt</h2>
                    <div class="btn-group">
                        <div class="custom-select" id="userDataUserSelectContainer">
                            <div class="select-trigger" id="userDataUserSelectTrigger">
                                <span>T·∫•t c·∫£ ng∆∞·ªùi d√πng</span>
                                <span class="arrow">‚ñº</span>
                            </div>
                            <ul class="select-options" id="userDataUserSelectOptions">
                                <li data-value="">T·∫•t c·∫£ ng∆∞·ªùi d√πng</li>
                            </ul>
                        </div>
                        <div class="custom-select" id="userDataFieldSelectContainer">
                            <div class="select-trigger" id="userDataFieldSelectTrigger">
                                <span>T·∫•t c·∫£ tr∆∞·ªùng</span>
                                <span class="arrow">‚ñº</span>
                            </div>
                            <ul class="select-options" id="userDataFieldSelectOptions">
                                <li data-value="">T·∫•t c·∫£ tr∆∞·ªùng</li>
                            </ul>
                        </div>
                        <button class="btn btn-success" id="exportUserDataBtn">üìä Xu·∫•t Excel</button>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-3">
                        <div class="stat-card">
                            <div class="stat-number" id="userDataTotal">0</div>
                            <div class="stat-label">T·ªïng d·ªØ li·ªáu</div>
                        </div>
                    </div>
                    <div class="col-3">
                        <div class="stat-card">
                            <div class="stat-number" id="userDataToday">0</div>
                            <div class="stat-label">H√¥m nay</div>
                        </div>
                    </div>
                    <div class="col-3">
                        <div class="stat-card">
                            <div class="stat-number" id="userDataUsers">0</div>
                            <div class="stat-label">Ng∆∞·ªùi ƒë√≥ng g√≥p</div>
                        </div>
                    </div>
                    <div class="col-3">
                        <div class="stat-card">
                            <div class="stat-number" id="userDataContributors">0</div>
                            <div class="stat-label">T·ªïng ng∆∞·ªùi ƒë√≥ng g√≥p</div>
                        </div>
                    </div>
                </div>
                
                <div id="userDataTableContainer">
                    <!-- User data table will be generated here -->
                </div>
            </div>
        </div>

        <!-- Export Tab -->
        <div class="tab-content" id="tab-export">
            <div class="dashboard-container">
                <div class="card-header">
                    <h2 class="card-title">Xu·∫•t D·ªØ li·ªáu</h2>
                </div>
                
                <div class="row">
                    <div class="col-2">
                        <div class="card">
                            <h3>Xu·∫•t t·∫•t c·∫£ d·ªØ li·ªáu</h3>
                            <p>Xu·∫•t to√†n b·ªô d·ªØ li·ªáu t·ª´ t·∫•t c·∫£ c√°c tr∆∞·ªùng</p>
                            <button class="btn btn-success btn-full" id="exportAllBtn">üìä Xu·∫•t Excel</button>
                        </div>
                    </div>
                    <div class="col-2">
                        <div class="card">
                            <h3>Xu·∫•t theo tr∆∞·ªùng</h3>
                            <div class="form-group">
                                <div class="custom-select" id="exportFieldSelectContainer">
                                    <div class="select-trigger" id="exportFieldSelectTrigger">
                                        <span>Ch·ªçn tr∆∞·ªùng</span>
                                        <span class="arrow">‚ñº</span>
                                    </div>
                                    <ul class="select-options" id="exportFieldSelectOptions">
                                        <li data-value="">Ch·ªçn tr∆∞·ªùng</li>
                                    </ul>
                                </div>
                            </div>
                            <button class="btn btn-secondary btn-full" id="exportFieldBtn">üìã Xu·∫•t tr∆∞·ªùng</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Application Scripts -->
    <script src="js/utils.js"></script>
    <script src="js/admin.js"></script>
    <script type="module" src="js/admin-panel.js"></script>
</body>
</html> 